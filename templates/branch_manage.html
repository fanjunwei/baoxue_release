{% extends 'base.html' %}
{% block header %}
    <script type="text/javascript">
        $(function () {
            $('#dropzone').filedrop({

                url: '{% url 'upload' %}',              // upload handler, handles each file separately, can also be a function taking the file and returning a url
                paramname: 'file',          // POST parameter name used on serverside to reference file, can also be a function taking the filename and returning the paramname
                withCredentials: true,          // make a cross-origin request with cookies
                error: function (err, file) {
                    switch (err) {
                        case 'BrowserNotSupported':
                            alert('browser does not support HTML5 drag and drop');
                            break;
                        case 'TooManyFiles':
                            alert('too many files');
                            break;
                        case 'FileTooLarge':
                            alert('too large files');
                            // program encountered a file whose size is greater than 'maxfilesize'
                            // FileTooLarge also has access to the file which was too large
                            // use file.name to reference the filename of the culprit file
                            break;
                        case 'FileTypeNotAllowed':
                            alert('file type not allowed');
                            break;
                        case 'FileExtensionNotAllowed':
                            alert('file extension not allowed');
                            break;
                        default:
                            break;
                    }
                },

                allowedfileextensions: ['.zip'], // file extensions allowed. Empty array means no restrictions
                maxfiles: 1,
                maxfilesize: 1000,    // max file size in MBs
                dragOver: function () {
                    // user dragging files over #dropzone
                },
                dragLeave: function () {
                    // user dragging files out of #dropzone
                },
                docOver: function () {
                    // user dragging files anywhere inside the browser document window
                },
                docLeave: function () {
                    // user dragging files out of the browser document window
                },
                drop: function () {
                    // user drops file
                },
                uploadStarted: function (i, file, len) {
                    alert('start upload');
                    // a file began uploading
                    // i = index => 0, 1, 2, 3, 4 etc
                    // file is the actual file of the index
                    // len = total files user dropped
                },
                uploadFinished: function (i, file, response, time) {
                    // response is the data you got back from server in JSON format.
                },
                progressUpdated: function (i, file, progress) {
                    // this function is used for large files and updates intermittently
                    // progress is the integer value of file being uploaded percentage to completion
                },
                globalProgressUpdated: function (progress) {
                    // progress for all the files uploaded on the current instance (percentage)
                    // ex: $('#progress div').width(progress+"%");
                },
                speedUpdated: function (i, file, speed) {
                    // speed in kb/s
                },
                rename: function (name) {
                    // name in string format
                    // must return alternate name as string
                },
                afterAll: function () {
                    // runs after all files have been uploaded or otherwise dealt with
                }
            });
        });
    </script>
{% endblock %}
{% block main %}
    <div class="path">版本管理|基础版本</div>
    <br>
    <form method="post" action="{% url 'branch_manage' %}">
        <input type="hidden" name="id" value="">
        <table style="border: solid green 1px">
            <tr>
                <td colspan="2">基础版本添加</td>
            </tr>
            <tr>
                <td><label for="branch">分支名</label></td>
                <td><input type="text" id="branch" name="branch">格式：A22_BXT_01</td>
            </tr>
            <tr>
                <td><label for="file">文件</label></td>
                <td>
                    <div id="dropzone" style="width: 100px;height: 100px;text-align: center;line-height: 100px;border: solid red 1px">
                        拖拽文件(Html5)
                    </div>
                </td>
            </tr>
            <tr>
                <td><label for="description">说明</label></td>
                <td><textarea type="text" cols="100" rows="5" id="description" name="description"></textarea></td>
            </tr>
            <tr>
                <td colspan="2"><input type="submit" value="添加"></td>
            </tr>
        </table>
    </form>

{% endblock %}